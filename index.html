<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Vilnius iGEM AR</title>


	<link href="./css/fonts.css" rel="stylesheet">
	<link href="./css/index.css" rel="stylesheet">


	<link href="./css/languagebox.css" rel="stylesheet">
	<link href="./css/opendyslexic.css" rel="stylesheet">
	<link href="./css/cookieconsent.css" rel="stylesheet">
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192" href="favicon/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
	<link rel="manifest" href="favicon/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
</head>

<body>
	<div id="pagepiling">
		<div id="intro" class="section">
			<div id="top" class="row">
				<div id="header-wrapper">
					<h3 id="header-one">6-asis</h3>
					<h2 id="header-two">SinBio</h2>
					<div id="head-text">
						<h1 id="main-text">
							<p id="static-text">pojūtis</p>
						</h1>
						<div>
							<svg version="1.1" id="movingDot" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 73.4 45.1" enable-background="new 0 0 73.4 45.1" xml:space="preserve">
								<polygon fill="#FCBD1B" stroke="#FCBD1B" stroke-width="11" stroke-linecap="round" stroke-linejoin="round" points="5.5,39.6 
	36.7,5.5 67.9,39.6 " />
							</svg>
						</div>
					</div>
				</div>


			</div>

			<div id="middle" class="row">
				<hr align="left" id="line">
				<p id="middle-text">Pažink gyvybės mokslus iš naujo panirdamas į AR ir QR technologijas.</p>

			</div>
			<div id="bottom" class="row">
				<svg version="1.1" id="arrows" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 73.4 100" enable-background="new 0 0 73.4 100" xml:space="preserve">
					<polyline id="top-triangle" fill="none" stroke="#FCBD1B" stroke-width="11" stroke-linecap="round" stroke-linejoin="round" points="5.5,5.5 
	36.7,39.6 67.9,5.5 " />
					<polyline fill="none" stroke="#FCBD1B" stroke-width="11" stroke-linecap="round" stroke-linejoin="round" points="5.6,60.4 
	36.8,94.5 68,60.4 " />
				</svg>
			</div>
		</div>


		<div id="main-menu" class="section">
			<div id="header">
				<div id="dyslexia"><img id="dysImg" src="images/disleksija.svg">
					<p id="dysText">Modifikacija<br>disleksijai</p>
				</div>
				<div id="languages"></div>
			</div>

			<div class="row" id="middle-menu">
				<div>
					<img src="./images/igem.png" height="442px" width="653px" alt="iGEM Vilnius Logo" id="logo">
				</div>

				<div class="row" id="navigation">
					<a href="./map.html">
						<p class="nav-button" id="button-map"></p>
					</a>
					<a href="./info.html">
						<p class="nav-button" id="button-instr"></p>
					</a>
					<a onclick="downloadMarkers()" download="ar-markers">
						<p class="nav-button" id="button-print"></p>
					</a>
					<a href="http://vilniusigem.lt" target="_blank" aria-label="Vilnius iGEM main page">
						<p class="nav-button" id="button-igem">iGEM</p>
					</a>
				</div>
			</div>
			<div class="row" id="footer">
				<a href="privacypolicy.html" id="privacy-policy">Privatumo politika</a>
			</div>
		</div>
	</div>
	<script>
		var cookieConsentApplyElement = document.getElementById("main-menu");

	</script>
	<script src="js/cookieconsent.js"></script>
	<script src="js/languages.js" charset="UTF-8"></script>
	<script src="js/opendyslexic.js" charset="UTF-8"></script>
	<script src="js/queryParams.js"></script>

	<script>
		let dotDocked = false;

		let movingDot = document.getElementById("movingDot");
		let arrows = document.getElementById("arrows");
		let headerWrapper = document.getElementById("header-wrapper");
		let line = document.getElementById("line");
		let topTriangle = document.getElementById("top-triangle");

		let distanceToBottom = 0;

		function setInitialElements() {
			let middle = document.getElementById("middle");

			// set arrow position and width
			let viewportOffsetDot = movingDot.getBoundingClientRect();
			arrows.style.width = viewportOffsetDot.width;
			arrows.style.marginLeft = viewportOffsetDot.left;
			arrows.style.visibility = "visible";

			// set lower text position and width
			let viewportOffsetWrapper = headerWrapper.getBoundingClientRect();
			middle.style.width = (viewportOffsetWrapper.width) + "px";
			document.getElementById("middle-text").style.width = (viewportOffsetWrapper.width * 0.9) + "px";
			middle.style.marginLeft = viewportOffsetWrapper.left + "px";
			middle.style.visibility = "visible";
			distanceToBottom = topTriangle.getBoundingClientRect().top - movingDot.parentElement.getBoundingClientRect().top - 3;
			if (!dotDocked) return; // dot is at initial position, do nothing

			// dot may have to move to new position, because it is docked
			dotDown();
		}

		window.addEventListener('load', setInitialElements);
		window.addEventListener('resize', setInitialElements);
		let scrollEvent = function() {
			if (!isInViewport(document.getElementById("header"))) {
				dotUp();
				dotDocked = false;
			} else if (!dotDocked) {
				dotDown();
				dotDocked = true;
			}
		};
		document.addEventListener("scroll", scrollEvent);


		function isInViewport(elem) {
			let bounding = elem.getBoundingClientRect();
			return (
				bounding.top >= 0 &&
				bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight)
			);
		};

		function dotDown() {
			// no delay, quick transition
			line.style.transitionDelay = "0s";
			line.style.transition = "0.3s";
			// line animation
			let lineWidth = headerWrapper.getBoundingClientRect().width - (movingDot.getBoundingClientRect().width * 1.5);
			line.style.width = lineWidth + "px";

			// dot animation
			movingDot.style.transform = "translateY(" + distanceToBottom + "px) rotate(180deg)";
		}

		function dotUp() {
			// delay, slow transition
			line.style.transition = "1s";
			line.style.transitionDelay = "0.6s";
			// line animation
			let lineWidth = headerWrapper.getBoundingClientRect().width;
			line.style.width = lineWidth + "px";

			// dot animation
			movingDot.style.transform = "translateY(0px) rotate(0deg)";
		}
		let texts = {
			lt: {
				"button-map": "Stotelių žemėlapis",
				"button-instr": "Instrukcija",
				"button-print": "Atsispausdink AR žymeklius",
				"header-one": "6-asis",
				"header-two": "SinBio",
				"static-text": "pojūtis",
				"middle-text": "Pažink gyvybės mokslus iš naujo panirdamas į AR ir QR technologijas.",
				"dysText": "Modifikacija<br>disleksijai",
				"privacy-policy": "Privatumo politika"
			},
			en: {
				"button-map": "Map of Stops",
				"button-instr": "Instructions",
				"button-print": "Print AR Markers",
				"header-one": "6th",
				"header-two": "SynBio",
				"static-text": "sense",
				"middle-text": "Experience life sciences through AR and QR technologies.",
				"dysText": "Modification<br>for dyslexia",
				"privacy-policy": "Privacy policy"
			}
		};

		function updateTexts(language) {
			let elements = Object.keys(texts.lt);
			for (let element of elements) {
				document.getElementById(element).innerHTML = texts[language][element];
			}
			setInitialElements();
		}

		updateTexts(LanguageSwitcher.currentLanguage);
		LanguageSwitcher.makeLanguageBox(document.getElementById("languages"), 0);
		LanguageSwitcher.addOnLanguageChangeListener(updateTexts);

		FontSwitcher.init();
		document.getElementById("dyslexia").onclick = () => FontSwitcher.toggle();

		function downloadMarkers() {
			if (LanguageSwitcher.currentLanguage == "en") {
				document.querySelector('[download="ar-markers"]').setAttribute('href', 'data/ar-markers-en.zip')
			} else {
				document.querySelector('[download="ar-markers"]').setAttribute('href', 'data/ar-markers-lt.zip')
			}
		}

	</script>
</body>

</html>
